import{_ as o,c,b as k,a as s,d as l,e as i,w as h,r as n,o as C}from"./app-B_sKV6fk.js";const E={};function u(v,a){const t=n("Annotation"),g=n("Mermaid"),r=n("VPIcon"),A=n("CodeTabs"),e=n("Card"),D=n("FlowChart"),y=n("Swiper"),B=n("VPLink");return C(),c("div",null,[a[56]||(a[56]=k('<h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言"><span>前言</span></a></h2><p>Wake-on-LAN(WOL, 网络唤醒)是一种以太网或令牌环计算机标准，允许通过网络消息开启或唤醒睡眠模式的计算机。该消息通常由连接到同一局域网 (LAN) 的设备上运行的程序发送到目标计算机。也可以通过使用子网定向广播或 WoL 网关服务从另一个网络发起消息。它基于 AMD 的 Magic Packet 技术 ，该技术由 AMD 和惠普共同开发，并于 1995 年被提议作为标准。</p><p>简而言之，就是能在局域网下通过发送魔术包的方式唤醒计算机。这有什么好处呢？</p><blockquote><p>试想一个场景，你的家里有一台配置比较高的电脑或服务器，安装一些开发环境，启动了一些服务：Nginx、Redis、Mysql、Kafka 等等。由于配置高又运行这么些服务，功耗也同样高，所以我们必然不会全天候运行，所以想过弄一个低功耗的小主机/小型服务器，7x24 小时不间断运行。 我考虑过迷你主机、Nas主机，但它们被设计的使用场景都不符合我的需求。看过不少品牌的迷你主机，它的性能通常比Nas高，但又不如我们的标准主机，而且它的扩展性也不如标准主机，如果运行我们开发所需的服务，它的功耗一样不会低，那么小的机身还要给它散热，有点太为难它的，那要它做甚？<br> 至于Nas，它的设计目标在于数据存储和共享，通常是 7x24 小时不间断运行，所以要在功耗和性能上做平衡。<br> 说来说去，又回到了问题的起点。那就换一种解决思路，能不能在需要的时候开启，不用的时候关闭呢？当然可以，这就需要用到 WOL 技术了。</p></blockquote><h2 id="_1-设置唤醒" tabindex="-1"><a class="header-anchor" href="#_1-设置唤醒"><span>1. 设置唤醒</span></a></h2><p>要想开启 Windows 的 WOL 功能有两个部分需要设置：BIOS设置、网卡设置。</p><h3 id="_1-1-bios设置" tabindex="-1"><a class="header-anchor" href="#_1-1-bios设置"><span>1.1 BIOS设置</span></a></h3><p>不同主板进入 BIOS 的方式不同，都可以谷歌得到，这里以我的微星主板为例。<br> 电脑开启时按<code>DEL</code>键进入，在<code>SETTING</code> -&gt; <code>高级</code> -&gt; <code>唤醒事件设置</code>，允许<code>网络唤醒</code>即可。同时还有一项<code>PCIE设备唤醒</code>，字面意思很容易理解，网卡就是一种<code>PCIE设备</code>，所以允许<code>网络唤醒</code>其实也就是允许<code>PCIE设备唤醒</code>，只不过微星把这两个概念拆开了。可能在有的主板上就只有一项<code>PCIE设备唤醒</code>，打开它也是一样的。但<code>PCIE设备</code>并不仅仅只有网卡，其他任何一个开发板只要是有 PCIE 接口可以插在主板上，那么它也可以成为唤醒设备，这其实就是留了一个<code>开放接口</code>的意思，你可以做各种 DIY 实现。这样，我们就可以实现电脑在<code>睡眠/休眠</code>中被唤醒了。</p><p>另外，在<code>电源管理设置</code>中有一项<code>ERP/ErP Ready</code>，它默认是打开的，如果想要电脑在<strong>关机下也能被唤醒</strong>，那就需要关闭它。ErP的意思是与能源有关的产品，它与欧盟对各种电子产品（包括个人电脑）通过的环境法规有关。启用 BIOS 里的 ErP 模式或使用 ErP Ready 设置，将使你的个人电脑在关闭时，可以关闭流向所有组件的电源，将总的电力消耗减少到1瓦或更少。<br> 说人话就是，禁用 ErP 在关机下几乎不耗电池，此时也不允许你用鼠标或键盘唤醒电脑，不能对传入的局域网信号作出反应，也就是说远程网络唤醒功能也因此失效了，那我们自然要禁用它。可能你会担心禁用后会好很多电吗？实际上并不会，禁用 ErP 后也就比启用它在关机下的功能多 1~2W，但这根本无所谓。按照民电 0.68元/度，2W 的设备 7x24 小时不间断运行，一年下来需要 11.91元的电费，相对于你在这一年里的开销来说，这不过于九牛一毛。</p><h3 id="_1-2-网卡设置" tabindex="-1"><a class="header-anchor" href="#_1-2-网卡设置"><span>1.2 网卡设置</span></a></h3>',10)),s("p",null,[a[5]||(a[5]=k("开机进入系统，按下<code>win+R</code>输入<code>ncpa.cpl</code>会打开<code>网络连接</code>，选择你当前使用的那个网卡(插的是网线就选<code>以太网</code>，连的 wifi 就选<code>WLAN</code>)，找到<code>属性</code> -&gt; <code>配置</code> -&gt; <code>电源管理</code>，勾选<code>允许此设备唤醒计算机</code>",18)),l(t,{label:"wol",total:2},{"item-0":h(()=>[...a[0]||(a[0]=[s("p",null,[s("strong",null,"作用"),i("：启用后，网卡可以在计算机处于睡眠(S3)或休眠(S4)状态时，通过特定信号唤醒计算机。")],-1)])]),"item-1":h(()=>[...a[1]||(a[1]=[s("p",null,[s("strong",null,"如何工作"),i("：这意味着，网卡不仅会响应“魔术数据包”(WOL数据包)，还可能响应其他网络活动(如收到数据包、网络流量等)来唤醒计算机。")],-1)])]),_:1}),a[6]||(a[6]=i("和",-1)),a[7]||(a[7]=s("code",null,"只允许幻数据包唤醒计算机",-1)),a[8]||(a[8]=i("(可选，但建议开启)",-1)),l(t,{label:"wol_only",total:2},{"item-0":h(()=>[...a[2]||(a[2]=[s("p",null,[s("strong",null,"作用"),i("：启用后，网卡只会响应特定的"),s("code",null,"魔术数据包"),i("来唤醒计算机，而不会响应其他任何网络活动或流量。魔术数据包的格式是：数据包头包含16个字节，的全0和6个字节的全1，后面跟着目标计算机的"),s("code",null,"MAC地址"),i("，并重复16次。")],-1)])]),"item-1":h(()=>[...a[3]||(a[3]=[s("p",null,[s("strong",null,"如何工作"),i("：魔术数据包是一种特定格式的数据包，其中包含目标计算机的网卡"),s("code",null,"MAC地址"),i("。该选项确保只有发送这种特定格式的数据包时，计算机才会被唤醒，从而提高唤醒的精确性和安全性。")],-1)])]),_:1}),a[9]||(a[9]=i("，并取消勾选",-1)),a[10]||(a[10]=s("code",null,"允许关闭计算机关闭此设备以节约电源",-1)),l(t,{label:"wol_power_off",total:1},{"item-0":h(()=>[...a[4]||(a[4]=[s("p",null,[i("当启用时，操作系统会让网络适配器在计算机进入休眠或关机时进入"),s("code",null,"省电模式"),i("，此时网卡会被完全关闭或进入低功耗状态，网卡"),s("strong",null,"无法接收任何网络请求或魔术数据包"),i("，无法唤醒计算机。")],-1)])]),_:1}),a[11]||(a[11]=i("。",-1))]),a[57]||(a[57]=k('<h2 id="_2-电源状态" tabindex="-1"><a class="header-anchor" href="#_2-电源状态"><span>2. 电源状态</span></a></h2><p>在 ACPI(高级配置与电源接口)规范中，定义了从 S0 到 S5 的一系列电源状态，用于描述操作系统如何控制计算机的电源管理。</p><table><thead><tr><th style="text-align:center;">状态</th><th style="text-align:center;">名称</th><th style="text-align:center;">描述</th></tr></thead><tbody><tr><td style="text-align:center;">S0</td><td style="text-align:center;">工作状态(Working)</td><td style="text-align:center;">系统完全运行，所有硬件设备正常供电</td></tr><tr><td style="text-align:center;">S1</td><td style="text-align:center;">待机状态(Standby)</td><td style="text-align:center;">CPU 停止执行指令，但保持供电，内存保留内容，唤醒非常快</td></tr><tr><td style="text-align:center;">S2</td><td style="text-align:center;">深度待机状态(Deeper Sleep)</td><td style="text-align:center;">类似 S1，但 CPU 和缓存完全断电；更省电，唤醒稍慢。很少使用</td></tr><tr><td style="text-align:center;">S3</td><td style="text-align:center;">睡眠状态(Sleep/Suspend to RAM)</td><td style="text-align:center;"><strong>内存保持供电</strong>，CPU 和外设断电；唤醒速度较快，常见的“睡眠”模式</td></tr><tr><td style="text-align:center;">S4</td><td style="text-align:center;">休眠状态(Hibernate/Suspend to Disk)</td><td style="text-align:center;"><strong>将内存内容保存到硬盘</strong>，然后全部断电；唤醒时从磁盘恢复，速度较慢，但更省电</td></tr><tr><td style="text-align:center;">S5</td><td style="text-align:center;">关机状态(Soft Off)</td><td style="text-align:center;">系统完全关闭，几乎无功耗，但仍可通过特定事件(如唤醒信号)启动</td></tr></tbody></table><p>可能之前我们会把睡眠(S3)和休眠(S4)弄混淆，事实上它们的定义标准是不同的。由于 RAM 的读写速度非常高，当我们从睡眠模式下唤醒到进入系统页面，通常只需要 2~3 秒；但硬盘的读写速度远不如 RAM ，即便是一个 SSD 硬盘，从休眠模式下唤醒到进入系统页面，可能也需要 7~8 秒。<br> 在 Windows11 系统中，我们发现只能看到<code>睡眠</code>，其实默认下<code>休眠</code>是被隐藏了，因为 Windows11 系统的<code>关机</code>和<code>休眠</code>就比较类似了，一样是把工作内容保存在硬盘，使得开机后可以迅速恢复。</p>',4)),s("p",null,[a[13]||(a[13]=i("按下",-1)),a[14]||(a[14]=s("code",null,"win+R",-1)),a[15]||(a[15]=i("输入",-1)),a[16]||(a[16]=s("code",null,"control",-1)),a[17]||(a[17]=i("打开",-1)),a[18]||(a[18]=s("code",null,"控制面板",-1)),a[19]||(a[19]=i("，选择",-1)),a[20]||(a[20]=s("code",null,"电源选项",-1)),a[21]||(a[21]=i("。在左侧的",-1)),a[22]||(a[22]=s("code",null,"选择电源按钮的功能",-1)),a[23]||(a[23]=i("中可以看到",-1)),a[24]||(a[24]=s("code",null,"休眠",-1)),a[25]||(a[25]=i("是没有被勾选的，我们可以勾选上",-1)),l(t,{label:"power",total:1},{"item-0":h(()=>[...a[12]||(a[12]=[s("p",null,[i("默认在"),s("code",null,"关机设置"),i("栏无法修改，此时点击上方的"),s("code",null,"更改当前不可用设置"),i("即可。")],-1)])]),_:1}),a[26]||(a[26]=k("，这样在按下<code>Win</code>键并点击<code>关机</code>按钮时就可以看到<code>休眠</code>的选项了。<br> 同时，我们注意的电源选项中还有一项<code>启用快速启动(推荐)</code>，它是默认被勾选的，正是由于启用了它，才得以让<code>关机</code>的效果和<code>休眠</code>类似，Windows 刻意隐藏了<code>休眠</code>开关，想用<code>快速启动</code>下的关机来达到<code>休眠</code>效果，也避免了<code>休眠</code>和<code>睡眠</code>的含义比较接近，导致用户感觉到歧义。",25))]),a[58]||(a[58]=k(`<p>此时，电脑就设置好了 WOl 唤醒了。可以通过<code>Fing</code>应用(支持Android和IOS)其中的<code>LAN唤醒</code>来验证，IOS 系统亦可下载<code>Awake</code>应用(免费无广，且可集成在<code>快捷指令</code>中)验证。如果有 OpenWrt 的软路由系统，可以安装<code>luci-i18n-wol-zh-cn</code>，将<code>网络唤醒</code>集成在 OpenWrt 中，便于操作。</p><p>至此，就已经设置好了主机网络唤醒。</p><h2 id="_3-设置休眠" tabindex="-1"><a class="header-anchor" href="#_3-设置休眠"><span>3.设置休眠</span></a></h2><p>上面说的都是把主机从<code>睡眠/休眠/关机</code>状态下唤醒，那么我们还想要在主机醒着的状态下进入到<code>睡眠/休眠/关机</code>状态如何做呢？这里当然不是要说在电脑上通过点击来操作，这样没有意思，我们需要通过<strong>指令</strong>的方式让主机进入到<code>睡眠/休眠/关机</code>状态。</p><p>通过命令行(cmd)窗口执行<code>shutdown --help</code>可以看到指令支持的操作如下：</p><div class="language-cmd has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="cmd" style="--vp-collapsed-lines:5;--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">用法: shutdown [/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> | /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">l</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> | /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">s</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> | /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">sg</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> | /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">r</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> | /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">g</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> | /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">a</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> | /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">p</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> | /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">h</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> | /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">e</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> | /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">o</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">] [/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">hybrid</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">] [/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">soft</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">] [/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">fw</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">] [/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">f</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">]</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    [/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">m</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> \\\\</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">computer</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">][/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> xxx][/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">d</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [p|u:]xx:yy [/</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">c</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">comment</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">]]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    没有参数   显示帮助。这与键入 /? 是一样的。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /?         显示帮助。这与不键入任何选项是一样的。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">         显示图形用户界面</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">GUI</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               这必须是第一个选项。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">l</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">         注销。这不能与 /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">m</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 或 /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">d</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 选项一起使用。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">s</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">         关闭计算机。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">sg</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        关闭计算机。在下一次启动时，如果启用了</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               自动重启登录，则将自动登录并锁定上次交互用户。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               登录后，重启任何已注册的应用程序。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">r</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">         完全关闭并重启计算机。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">g</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">         完全关闭并重启计算机。重新启动系统后，</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               如果启用了自动重启登录，则将自动登录并</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               锁定上次交互用户。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               登录后，重启任何已注册的应用程序。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">a</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">         中止系统关闭。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               这只能在超时期间使用。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               与 /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">fw</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 结合使用，以清除任何未完成的至固件的引导。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">p</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">         关闭本地计算机，没有超时或警告。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               可以与 /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">d</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 和 /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">f</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 选项一起使用。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">h</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">         休眠本地计算机。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               可以与 /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">f</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 选项一起使用。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">hybrid</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    执行计算机关闭并进行准备以快速启动。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               必须与 /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">s</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 选项一起使用。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">fw</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        与关闭选项结合使用，使下次启动转到</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               固件用户界面。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">e</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">         记录计算机意外关闭的原因。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">o</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">         转到高级启动选项菜单并重新启动计算机。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               必须与 /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">r</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 选项一起使用。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">m</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> \\\\</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">computer</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 指定目标计算机。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> xxx     将关闭前的超时时间设置为 xxx 秒。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               有效范围是 </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0-315360000</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">10</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 年</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">，默认值为 </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">30</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               如果超时期限大于 </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">，则 /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">f</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 参数为</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">f</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 参数。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">c</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">comment</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 注释重启或关闭的原因。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               最多允许 </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">512</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 个字符。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">f</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">         强制关闭正在运行的应用程序而不事先警告用户。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               当大于 </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 的值为</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 时，隐含 /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">f</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 参数               则默示为 /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">f</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 参数。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    /</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">d</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [p|u:]xx:yy  提供重新启动或关闭的原因。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               p 指示重启或关闭是计划内的。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               u 指示原因是用户定义的。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               如果未指定 p 和 u，则</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">重新启动或关闭               是计划外的。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               xx 是主要原因编号</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">小于 </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">256</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 的正整数</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">。</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">               yy 是次要原因编号</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">小于 </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">65536</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 的正整数</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">此计算机上的原因:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">E</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 预期 </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">U</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 意外 </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">P</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 计划内，</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">C</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 自定义</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="collapsed-lines"></div></div><p>这里关注几个我们需要的：</p><table><thead><tr><th style="text-align:center;">指令</th><th style="text-align:center;">效果</th></tr></thead><tbody><tr><td style="text-align:center;">shutown /s</td><td style="text-align:center;">关机</td></tr><tr><td style="text-align:center;">shutown /h</td><td style="text-align:center;">休眠</td></tr><tr><td style="text-align:center;">shutown /r</td><td style="text-align:center;">重启</td></tr></tbody></table><p>但是，我们没有看到<code>睡眠</code>的指令。经过一番搜索，找到两条<code>指令</code>可以实现<code>睡眠或休眠</code>的效果：<code>rundll32.exe powrprof.dll,SetSuspendState 0,1,0</code>或<code>rundll32.exe powrprof.dll,SetSuspendState Sleep</code>。这两种指令经过验证效果是一样的。<br> 为什么说是实现<code>睡眠或休眠</code>的效果呢？即<code>睡眠</code>和<code>休眠</code>只能二选一，那什么时候是睡眠，什么时候是休眠呢？</p><p>默认情况下，<code>休眠</code>功能是启用的，那么上面的<code>指令</code>效果就是休眠，则它等价于<code>shutown /h</code>。可以通过<code>powercfg -h off</code>(powershell 管理员权限)来关闭<code>休眠</code>功能，此时<code>shutdown /h</code>指令会失效，同时在<code>电源选项</code>中亦不存在<code>休眠</code>和<code>启用快速启动(推荐)</code>的设置，而<code>指令</code>的效果也就变成<code>睡眠</code>了。所以，需要斟酌一下，到底要不要关闭<code>休眠</code>功能。如果关闭<code>休眠</code>后想再次打开，可执行<code>powercfg -h on</code>。<br> 如何分辨是从睡眠中醒来，还是从休眠中醒来？查看主机唤醒时，显示器有没有显示主板BIOS的图案，如果有就说明是从休眠中醒来，否则不是。</p><h2 id="_4-进阶操作" tabindex="-1"><a class="header-anchor" href="#_4-进阶操作"><span>4. 进阶操作</span></a></h2><p>如何便捷地通过 iPhone 在局域网下唤醒/休眠主机？这里我总结了一套实践经验。<br> 因为 IOS 的快捷指令中支持 SSH 连接并发送指令，那么完全可以通过 SSH 连接到 OpenWrt/Windows 来实现唤醒/休眠主机，但是考虑到操作统一性和便捷性，我实际的做法是：</p>`,12)),l(g,{code:"eJxLy8kvT85ILCpR8AniUgACT/9gBV1dO4Uaj5CQgBoF/4LUvPCiErAUlA2RDg72qFEIz8xLyS8v5gIA5fAVKQ=="}),a[59]||(a[59]=s("h3",{id:"_4-1-windows-部分",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_4-1-windows-部分"},[s("span",null,"4.1 Windows 部分")])],-1)),l(e,{title:"触发脚本",icon:"twemoji:information"},{default:h(()=>[a[31]||(a[31]=s("p",null,[i("然而在实操踩坑中发现，对于"),s("code",null,"shutdown /s"),i("(关机)和"),s("code",null,"shutdown /r"),i("(重启)的指令响应逻辑没问题，但是"),s("code",null,"睡眠"),i("或"),s("code",null,"休眠"),i("就有问题了，直接执行相关命令会导致，主机刚进入"),s("code",null,"睡眠"),i("或"),s("code",null,"休眠"),i("状态又立即被唤醒了。"),s("br"),i(" 因此我在 Windows 用户目录下放了两个"),s("code",null,"bat"),i("脚本，定义了临时触发器来执行操作，供 OpenWrt 通过 SSH 调用，具体如下。")],-1)),l(A,{id:"207",data:[{id:"trigger_sleep.bat"},{id:"trigger_hibernate.bat"}]},{title0:h(({value:p,isActive:d})=>[l(r,{provider:"iconify",name:"vscode-icons:file-type-bat"}),a[27]||(a[27]=s("span",null,"trigger_sleep.bat",-1))]),title1:h(({value:p,isActive:d})=>[l(r,{provider:"iconify",name:"vscode-icons:file-type-bat"}),a[28]||(a[28]=s("span",null,"trigger_hibernate.bat",-1))]),tab0:h(({value:p,isActive:d})=>[...a[29]||(a[29]=[s("div",{class:"language-bat","data-highlighter":"shiki","data-ext":"bat",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-bat"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"@"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"echo"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}}," off")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"setlocal")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},":: 获取当前时间 + 1 分钟")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"for"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /f "),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"tokens=1,2 delims=:"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," %%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"a"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}}," in"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ("),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"time"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}}," do"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," (")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"    set"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /a "),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"1"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"a"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," %%"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 100")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"    set"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /a "),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"1"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"b"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," +"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"if"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," %"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," GEQ"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 60"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," (")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"    set"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /a "),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"    set"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /a "),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"+="),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"if"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," %"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," GEQ"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 24"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}}," set"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /a "),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"0")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},":: 格式化为 HH:MM（确保补零）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"set"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"0"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"set"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"0"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"set"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"=%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},":~"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"-2"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"set"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"=%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},":~"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"-2"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},":: 创建一次性计划任务，执行“睡眠”")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"schtasks"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /create /tn "),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"TriggerSleep"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /tr "),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"rundll32.exe powrprof.dll,SetSuspendState 0,1,0"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /sc once /st "),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},":"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /f "),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},">"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"nul")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"schtasks"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /run /tn "),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"TriggerSleep"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," >"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"nul")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"echo"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," Will sleep at "),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},":"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"endlocal")])])])],-1)])]),tab1:h(({value:p,isActive:d})=>[...a[30]||(a[30]=[s("div",{class:"language-bat","data-highlighter":"shiki","data-ext":"bat",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-bat"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"@"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"echo"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}}," off")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"setlocal")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},":: 获取当前时间 + 1 分钟")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"for"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /f "),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"tokens=1,2 delims=:"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," %%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"a"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}}," in"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ("),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"time"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}}," do"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," (")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"    set"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /a "),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"1"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"a"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," %%"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 100")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"    set"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /a "),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"1"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"b"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," +"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"if"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," %"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," GEQ"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 60"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," (")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"    set"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /a "),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"    set"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /a "),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"+="),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"if"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," %"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," GEQ"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 24"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}}," set"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /a "),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"0")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},":: 格式化为 HH:MM（确保补零）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"set"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"0"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"set"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"0"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"set"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"=%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},":~"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"-2"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"set"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"=%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},":~"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"-2"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},":: 创建一次性计划任务")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"schtasks"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /create /tn "),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"TriggerHibernate"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /tr "),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"shutdown /h"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /sc once /st "),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},":"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /f "),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},">"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"nul")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"schtasks"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," /run /tn "),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"TriggerHibernate"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," >"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"nul")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"echo"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," Will hibernate at "),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"hh"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},":"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"mm"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"%")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"endlocal")])])])],-1)])]),_:1}),a[32]||(a[32]=s("p",null,[i("这两个脚本，"),s("code",null,"trigger_sleep.bat"),i("是用来触发"),s("code",null,"睡眠"),i("指令，"),s("code",null,"trigger_hibernate.bat"),i("是用来触发"),s("code",null,"休眠"),i("指令。")],-1))]),_:1}),l(e,{title:"开启SSH",icon:"twemoji:information"},{default:h(()=>[a[48]||(a[48]=s("p",null,[i("如果想通过 SSH 来管理 Windows 系统，就需要安装"),s("code",null,"OpenSSH"),i("服务，Windows11 默认已经安装了 SSH 的客户端，此时我们安装服务端。"),s("br"),i(" 有两种方式安装：")],-1)),s("p",null,[a[34]||(a[34]=i("方式一：",-1)),a[35]||(a[35]=s("br",null,null,-1)),a[36]||(a[36]=i(" 进入",-1)),a[37]||(a[37]=s("code",null,"设置",-1)),a[38]||(a[38]=i("->",-1)),a[39]||(a[39]=s("code",null,"系统",-1)),a[40]||(a[40]=i("->",-1)),a[41]||(a[41]=s("code",null,"可选功能",-1)),a[42]||(a[42]=i("->",-1)),a[43]||(a[43]=s("code",null,"添加可选功能",-1)),a[44]||(a[44]=i("，搜索",-1)),a[45]||(a[45]=s("code",null,"OpenSSH 服务器",-1)),a[46]||(a[46]=i("安装",-1)),l(t,{label:"openssh",total:1},{"item-0":h(()=>[...a[33]||(a[33]=[s("p",null,[i("windwos系统版本不同可能入口不太一样，有的是在"),s("code",null,"设置"),i("->"),s("code",null,"应用"),i("->"),s("code",null,"可选功能"),i("->"),s("code",null,"添加可选功能")],-1)])]),_:1}),a[47]||(a[47]=i("。",-1))]),a[49]||(a[49]=s("p",null,"方式二：",-1)),a[50]||(a[50]=s("div",{class:"language-powershell","data-highlighter":"shiki","data-ext":"powershell",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-powershell"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 安装")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"Add-WindowsFeature"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," -"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"Name OpenSSH"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"-"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"Client"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},","),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," OpenSSH"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"-"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"Server")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 安装完成后就自动运行了")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 查看")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"Get-Service"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," -"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"Name sshd")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 连接测试")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"ssh localhost")])])])],-1)),a[51]||(a[51]=s("p",null,[i("设置为开机自启：按"),s("code",null,"WIN"),i("键搜索"),s("code",null,"计算机管理"),i("，然后打开"),s("code",null,"服务"),i("找到"),s("code",null,"OpenSSH SSH Server"),i("，修改属性将"),s("code",null,"启动类型"),i("调整为"),s("code",null,"自动(延迟启动)"),i("。")],-1))]),_:1}),l(e,{title:"SSH密钥登录",icon:"twemoji:information"},{default:h(()=>[...a[52]||(a[52]=[s("p",null,[i("可以借助"),s("strong",null,"Git bash"),i("生成密钥，执行"),s("code",null,"ssh-keygen -t rsa -f ~/.ssh/id_rsa"),i("(生成RSA密钥)或"),s("code",null,"ssh-keygen -t ed25519 -f ~/.ssh/id_rsa"),i("(生成ed25519密钥)，前者广泛兼容，后者安全性更高，随便选择一种即可。"),s("br"),i(" 然后把生成的密钥对中的公钥内容复制到 Windwos 用户目录下的"),s("code",null,".ssh\\authorized_keys"),i("文件中，如果文件不存在可自行创建，注意文件没有后缀。示例：")],-1),s("div",{class:"code-block-title","data-title":"authorized_keys"},[s("div",{class:"code-block-title-bar"},[s("span",{class:"title"},"authorized_keys")]),s("div",{class:"language-text","data-highlighter":"shiki","data-ext":"text",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-text"},[s("span",{class:"line"},[s("span",null,"  ssh-rsa AAAAB4NzaC1yc2EAAAADAQABAAABAQCC8P8z96xo2EcfejdrvEt/6Tc2qhX7FhLevcqjhNvQYPYmQaMwZElsi0QAABAQCC9P8z96xo1EcfejdrvdrvEt/9Tc2q root@ImmortalWrt")])])])])],-1),s("p",null,[i("接着就是 Windows 的特有操作，更改"),s("code",null,"authorized_keys"),i("文件权限，否则无法通过密钥登录。以下命令"),s("strong",null,"二选一"),i("即可：")],-1),s("div",{class:"language-bash","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-bash"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"  # 远程通过 ACL 更改权限")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  ssh"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," --%"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," mayee@192.168.0.88"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," icacls.exe"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},' "'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"C:\\Users\\mayee\\.ssh\\authorized_keys"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /inheritance:r"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /grant"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},' "'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"Administrators:F"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /grant"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},' "'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"SYSTEM:F"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /grant"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},' "'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"mayee:F"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"  # 服务端修改权限")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  icacls.exe"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},' "'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"C:\\Users\\mayee\\.ssh\\authorized_keys"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /inheritance:r"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /grant"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},' "'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"Administrators:F"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /grant"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},' "'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"SYSTEM:F"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /grant"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},' "'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"maye:F"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"')])])])],-1),s("p",null,[i("注意：这个操作是授权，表示"),s("code",null,"Administrators"),i("、"),s("code",null,"SYSTEM"),i("和"),s("code",null,"mayee"),i("将有完全控制权限，一定要把自己的用户名加上，否则之后无法修改此文件。如果忘了加可以用此命令补"),s("code",null,'icacls "C:\\Users\\mayee\\.ssh\\authorized_keys" /grant "mayee:F"'),i("。")],-1),s("p",null,[i("在 Windows OpenSSH 中，默认的授权密钥存放位置为"),s("code",null,"ProgramData\\ssh\\administrators_authorized_keys"),i("，此位置对应为管理用户权限。因此需要修改默认授权文件位置。通过文本编辑器(如 VSCode)打开"),s("code",null,"ProgramData\\ssh\\sshd_config"),i("，修改以下条目(需要管理员权限，也可以把文件复制出去，改完后再覆盖回来)：")],-1),s("div",{class:"code-block-title","data-title":"sshd_config"},[s("div",{class:"code-block-title-bar"},[s("span",{class:"title"},"sshd_config")]),s("div",{class:"language-cmd","data-highlighter":"shiki","data-ext":"cmd",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-cmd"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"  #允许公钥授权访问，确保条目不被注释")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"  PubkeyAuthentication yes")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"  #授权文件存放位置，确保条目不被注释")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"  AuthorizedKeysFile ."),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"ssh"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"/"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"authorized_keys")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"  #可选，关闭密码登录，提高安全性")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"  PasswordAuthentication no")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"  #注释掉默认授权文件位置，确保以下条目被注释")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"  #Match Group administrators")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"  #       AuthorizedKeysFile "),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"__PROGRAMDATA__"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"/"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"ssh"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"/"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"administrators_authorized_keys")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"  # 注意，OpenSSH "),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"8.8"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," 及以上版本中，默认禁用了使用 "),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"SHA"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"-1"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," 哈希算法的 RSA 签名，如果你用的 RSA 密钥就需要加这两行，ed25519 密钥则不需要加")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"  HostKeyAlgorithms"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," +"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"ssh"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"rsa")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"  PubkeyAcceptedAlgorithms"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," +"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"ssh"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"rsa")])])])])],-1),s("p",null,[i("重启 OpenSSH 服务：在 PowerShell 中执行"),s("code",null,"Restart-Service sshd"),i("(管理员权限)。"),s("br"),i(" 相关指令：")],-1),s("div",{class:"language-powershell","data-highlighter":"shiki","data-ext":"powershell",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-powershell"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"  Get-Service"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," sshd  "),s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 查看状态")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"  Stop-Service"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," sshd "),s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 关闭服务")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"  Restart-Service"),s("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," sshd "),s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 重启服务")])])])],-1)])]),_:1}),a[60]||(a[60]=k(`<h3 id="_4-2-openwrt-部分" tabindex="-1"><a class="header-anchor" href="#_4-2-openwrt-部分"><span>4.2 OpenWrt 部分</span></a></h3><p>前文提到可以安装<code>luci-i18n-wol-zh-cn</code>，它是一个可视化的操作页面，功能实现依赖的是<code>etherwake</code>，也就是说只安装<code>etherwake</code>用命令行的方式操作就可以了，那样连 OpenWrt 后台页面都不用进。</p><p>可以在 OpenWrt 后台页面<code>软件包</code>中安装<code>etherwake</code>，或者执行命令<code>opkg install etherwake</code>。</p><p>在 OpenWrt 中，LuCI(Lua Configuration Interface) 是其默认的 Web 界面管理系统，LuCI 本质是 一套用 Lua 编写的 Web 应用逻辑，是一种让 Web 服务器运行外部程序（通常是脚本）的标准接口协议，用来处理动态网页请求。但它并不自带服务器功能，它必须运行在一个 Web 服务器之上，而 uHTTPd 是 OpenWrt 默认提供的轻量级 Web 服务器。</p><table><thead><tr><th style="text-align:center;">文件</th><th style="text-align:center;">说明</th></tr></thead><tbody><tr><td style="text-align:center;"><code>/etc/config/luci</code></td><td style="text-align:center;">LuCI 的主配置文件，如语言、主题、界面行为等设置</td></tr><tr><td style="text-align:center;"><code>/etc/config/uhttpd</code></td><td style="text-align:center;">uHTTPd 的配置文件，控制 Web 服务监听地址、端口、SSL 等</td></tr><tr><td style="text-align:center;"><code>/etc/config/rpcd</code></td><td style="text-align:center;">控制 LuCI 使用的 UBUS RPC 权限（例如哪些用户可以远程读写配置）</td></tr></tbody></table><p><code>cat /etc/config/uhttpd</code>查看配置文件：</p><div class="code-block-title" data-title="uhttpd"><div class="code-block-title-bar"><span class="title">uhttpd</span></div><div class="language-bash line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="bash" style="--vp-collapsed-lines:10;--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">config</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> uhttpd</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">main</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        list</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> listen_http</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">0.0.0.0:80</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        list</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> listen_http</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[::]:80</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        # 因为我们主要是内网访问，所以注释掉 443 端口的监听，后面留作他用</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        #list listen_https &#39;0.0.0.0:443&#39;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        #list listen_https &#39;[::]:443&#39;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> redirect_https</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">0</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # http 不要自动重定向到 https</span></span>
<span class="line highlighted"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> home</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/www</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # Web 根目录，访问静态页面文件的起点</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rfc1918_filter</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 拒绝非私有网段的 IP 访问（例如来自公网 IP），防止 uhttpd 被意外暴露到公网</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> max_requests</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">50</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 每个进程最多处理 50 个请求</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> max_connections</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">100</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 最多同时允许 100 个连接</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cert</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/etc/uhttpd.crt</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> key</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/etc/uhttpd.key</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line highlighted"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cgi_prefix</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/cgi-bin</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # CGI 请求的路径前缀</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        list</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> lua_prefix</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/cgi-bin/luci=/usr/lib/lua/luci/sgi/uhttpd.lua</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 将所有 /cgi-bin/luci 开头的请求交由指定的 Lua 脚本处理，这就是 LuCI 的运行入口。/usr/lib/lua/luci/sgi/uhttpd.lua 是 uHTTPd 专用的 LuCI CGI 启动器</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> script_timeout</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">3600</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 设置 CGI 脚本最长执行时间为 3600 秒（1 小时），适合处理比较慢的后台任务</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> network_timeout</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">30</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 客户端连接最长空闲时间（秒）。超过 30 秒没有数据就断开连接</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http_keepalive</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">20</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 单个连接最多保持 20 次复用，利于浏览器访问多个资源（JS/CSS）</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tcp_keepalive</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 开启 TCP keepalive，检测空闲连接是否掉线</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ubus_prefix</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/ubus</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 设置 uHTTPd 暴露的 UBUS HTTP API 前缀为 /ubus，用于 RPC 接口</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> interpreter</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">.sh=/bin/sh</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 定义 .sh 脚本用 /bin/sh 来解释，便于创建简单的 CGI 脚本页面</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">config</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cert</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">defaults</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> days</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">397</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 自签证书有效期 397 天</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> key_type</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ec</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> bits</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">256</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ec_curve</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">P-256</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> country</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ZZ</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> state</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Somewhere</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> location</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Unknown</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        option</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> commonname</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ImmortalWrt</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div></div><p>可以看到服务器文件都放在<code>/www</code>目录下，cgi 的前缀是<code>cgi-bin</code>。因此，为了便捷我我们在<code>/www/cgi-bin</code>目录下新增一个文件<code>wol</code>：</p><div class="code-block-title" data-title="wol"><div class="code-block-title-bar"><span class="title">wol</span></div><div class="language-bash line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="bash" style="--vp-collapsed-lines:5;--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#!/bin/sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 主机 MAC</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">mac</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">A8:DD:77:CC:00:99</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">user</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">mayee</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">host</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">192.168.0.88</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 从 URL 路径获取参数</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">p1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=$(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$PATH_INFO</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> sed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">s#^/##</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 获取 GET 参数</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">p2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=$(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$QUERY_STRING</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> sed</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -n</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">s/.*cmd=\\([^&amp;]*\\).*/\\1/p</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 优先取路径参数，没有则取 GET 参数，还没有就是空</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> -n</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$p1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ];</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> then</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    cmd</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$p1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">elif</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> -n</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$p2</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ];</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> then</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    cmd</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$p2</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">else</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    cmd</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">reply</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(){</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Content-type: text/plain; charset=utf-8</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # http 格式要求必须空一行</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">remote_cmd</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # -i 用来指定私钥的位置</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    ssh</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -i</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /root/.ssh/id_rsa</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $user</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">@</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">$host</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">case</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$cmd</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> in</span></span>
<span class="line"><span style="--shiki-light:#AB5E3F;--shiki-dark:#C4704F;">  ping</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # -c 发送一次，-t 超时 10ms(内网环境下 ping 不会有高延迟，10ms 足够长了)。成功返回 1，失败返回 0</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    fping</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -c</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -t</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $host</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /dev/null</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &amp;&amp;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> reply</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ||</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> reply</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ;;</span></span>
<span class="line"><span style="--shiki-light:#AB5E3F;--shiki-dark:#C4704F;">  sleep</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">)</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    result</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">remote_cmd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> trigger_sleep.bat</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    reply</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $result</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ;;</span></span>
<span class="line"><span style="--shiki-light:#AB5E3F;--shiki-dark:#C4704F;">  wake</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # -i 用来指定网卡名，参数可选</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    etherwake</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -i</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> br-lan</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $mac</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> &amp;&amp;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> reply</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> packet</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> snet</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ;;</span></span>
<span class="line"><span style="--shiki-light:#AB5E3F;--shiki-dark:#C4704F;">  shutdown</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">)</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    result</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">remote_cmd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> shutdown</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /f</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /t</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 或者用 shutdown /p</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    reply</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $result</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ;;</span></span>
<span class="line"><span style="--shiki-light:#AB5E3F;--shiki-dark:#C4704F;">  reboot</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">)</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    result</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">remote_cmd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> shutdown</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /r</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /f</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /t</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    reply</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $result</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ;;</span></span>
<span class="line"><span style="--shiki-light:#AB5E3F;--shiki-dark:#C4704F;">  hibernate</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">)</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    result</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">remote_cmd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> trigger_hibernate.bat</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    reply</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $result</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ;;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">  *)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    reply</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cmd_error:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $cmd</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ;;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">esac</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div></div><p>然后可以通过<code>http://192.168.0.88/cgi-bin/wol/&lt;cmd&gt;</code>访问。cmd 可选值：</p><ul><li><code>ping</code>：检测主机是否在线</li><li><code>sleep</code>：睡眠</li><li><code>hibernate</code>：休眠</li><li><code>wake</code>：唤醒</li><li><code>shutdown</code>：关机</li><li><code>reboot</code>：重启</li></ul><h3 id="_4-3-ios-部分" tabindex="-1"><a class="header-anchor" href="#_4-3-ios-部分"><span>4.3 IOS 部分</span></a></h3><p>IOS 快捷指令请求 OpenWrt 脚本的逻辑流程如下：</p>`,13)),l(D,{code:"eJwrLrG1Ky5JLCqxUni6f/Wz3u3Petqf7F6i4ekfrMmVamuXmpdipfB89+Rnc+dzFdjaZeYVlJbkl5YASaCG/okvGxoDMvPSn07cC9RkZZdRUlJgpa9vaGmkZ2hmoWegZ2Ghn5yeqZuUmadfnp+jXwBUy5Wcn5diawciM0sy8/OsFJ7s2P1szq6nc1Y837Xfniu/oNLWLr8gtSgRIvuif87T3qkaz+cu1H+yZ+LzOQt0nrZuBqrXedne+3TCep2XDQ1P23dpAvXlYdP3dMqSl22T4KqKS3TtCjSKMtMzSjR1wY4Au0ejMrVYRwEmDHSCrl0qRCIvHyyQBxIAAFGEhL8=",preset:"vue"}),l(y,{items:["https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/20250522/IMG_8293.51edqm77cg.webp","https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/20250522/IMG_8294.7piuhpzlr.webp"],width:300,effect:"cube"}),a[61]||(a[61]=s("h2",{id:"结语",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#结语"},[s("span",null,"结语")])],-1)),s("p",null,[a[54]||(a[54]=i("上述这套打法可以轻松实现在局域网内，用 iPhone 手机管理主机。可能你会说只能在局域网中使用还是有点鸡肋啊，能不能不在局域网也可以管理主机呢？当然可以，这也是我们下一篇文章的主题：",-1)),l(B,{href:"/article/r9qcnh6l/"},{default:h(()=>[...a[53]||(a[53]=[i("Lucky内网穿透实践",-1)])]),_:1}),a[55]||(a[55]=i("。",-1))])])}const b=o(E,[["render",u]]),f=JSON.parse('{"path":"/article/u0ns75tk/","title":"Windwos下启用WOL功能","lang":"zh-CN","frontmatter":{"title":"Windwos下启用WOL功能","tags":["Windows","WOL"],"categories":["技巧"],"createTime":"2025/05/10 19:25:32","permalink":"/article/u0ns75tk/"},"readingTime":{"minutes":19.67,"words":5901},"git":{"createdTime":1769985102000,"updatedTime":1769985102000,"contributors":[{"name":"Mayee","username":"Mayee","email":"may675154357@gmail.com","commits":1,"avatar":"https://avatars.githubusercontent.com/Mayee?v=4","url":"https://github.com/Mayee"}]},"filePathRelative":"blog/6.技巧/4.Windwos下启用WOL功能.md","headers":[],"categoryList":[{"id":"f5b792","sort":6,"name":"技巧"}]}');export{b as comp,f as data};
