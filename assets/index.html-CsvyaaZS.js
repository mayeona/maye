import{_ as i,c as a,b as t,o as e}from"./app-B_sKV6fk.js";const n={};function h(p,s){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言"><span>前言</span></a></h2><p>之前一直用 Hyper-v，但是管理控制台功能太少，遂决定转到 VMware 虚拟机，后续做集群、K8s等也方便管理。</p><h2 id="_1-安装-ubuntu" tabindex="-1"><a class="header-anchor" href="#_1-安装-ubuntu"><span>1. 安装 ubuntu</span></a></h2><p>安装 ubuntu 并设置静态 ip。</p><p><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_01.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_02.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_03.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_04.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_05.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_06.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_07.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_08.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_09.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_10.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_11.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_12.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_13.webp" alt="按空格选中"><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_14.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_15.webp" alt=""><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/01_1_16.webp" alt=""></p><p>设置镜像源：</p><p>https://mirror.tuna.tsinghua.edu.cn/help/ubuntu/ -&gt; https://mirrors.tuna.tsinghua.edu.cn/ubuntu</p><p>https://mirrors.aliyun.com/ubuntu</p><p>阿里云比清华大学镜像快一些。</p><h2 id="_2-设置虚拟机网络" tabindex="-1"><a class="header-anchor" href="#_2-设置虚拟机网络"><span>2. 设置虚拟机网络</span></a></h2><p>虚拟机网络模式有三种，桥接、仅主机、NAT。经过比较后，选择 NAT 模式。 NAT 模式可以设置虚拟机网段，就不用受宿主机网络变化的影响了。</p><p>注意 nat 模式下，除了 ssh 可以用 192.168.10.100 访问到，譬如 30880 只能通过本机访问，在 vm 中配置端口转发</p><h2 id="_3-设置-root-账户" tabindex="-1"><a class="header-anchor" href="#_3-设置-root-账户"><span>3. 设置 root 账户</span></a></h2><p>设置 root 账户密码：sudo passwd root ，然后连续输入两次密码。切换到 root 账户：su root。切回普通用户：exit。</p><h2 id="_4-主机开机自启" tabindex="-1"><a class="header-anchor" href="#_4-主机开机自启"><span>4. 主机开机自启</span></a></h2><p>以 WMware Workstation 17 pro 为例，在<code>文件</code>-&gt;<code>配置启动虚拟机</code>，勾选你要启动的虚拟机即可。</p><blockquote><p><strong>可能遇到问题？</strong></p><p>提示无法更新<code>自动启动</code>配置，请确保存在<code>vmAutoStart.xml</code>文件，并且您有权写入此文件。</p></blockquote><p>实际上这个文件是存在的，在<code>C:\\ProgramData\\VMware\\VMware Workstation\\vmAutoStart.xml</code>，文件内容示例如下：</p><div class="language-xml" data-highlighter="shiki" data-ext="xml" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-xml"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;?</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">xml</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> version</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">1.0</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> encoding</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">UTF-8</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">&lt;!-- 配置虚拟机自动启动规则 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ConfigRoot</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AutoStartOrder</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  &lt;!-- 这里配置名为 devos 的虚拟机开机自启，顺序为 1 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">e</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> id</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">vmname</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">devos</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">vmname</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">vmxpath</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">C:\\Users\\</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">用户名</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">\\Documents\\Virtual Machines\\devos\\devos.vmx</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">vmxpath</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">startOrder</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">startOrder</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    &lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AutoStartOrder</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ConfigRoot</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span></code></pre></div><p>其实是没有写入权限，右键点击该文件<code>属性</code>→<code>安全</code>，确保当前用户或 SYSTEM 有<code>完全控制权</code>。</p><p><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/PixPin_2025-06-18_05-46-49.7p3v2z01n8.webp" alt="PixPin_2025-06-18_05-46-49"></p><p>按下<code>win+R</code>，输入<code>services.msc</code>找到<code>Vmware 自动启动服务</code>右击-&gt;<code>属性</code>，在<code>常规</code>-&gt;<code>启动类型</code>选择<code>自动</code>。</p><div class="hint-container warning"><p class="hint-container-title">注意</p><p>不要使用<code>自动(延迟启动)</code>，否则可能自启无效。</p></div><p><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/PixPin_2025-06-18_08-56-32.8vn6brhkwc.webp" alt="PixPin_2025-06-18_08-56-32"></p><p>接着继续在上面的 tab 栏中选择<code>登录</code>(这点<strong>很重要</strong>)。</p><p>如果是使用<strong>本地账户</strong>登录的选择：</p><p><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/PixPin_2025-06-18_06-12-48.lvzndrq30.webp" alt="PixPin_2025-06-18_06-12-48"></p><p>如果是使用<strong>微软账户</strong>登录的选择：</p><p><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/PixPin_2025-06-18_06-14-37.92qe71aki5.webp" alt="PixPin_2025-06-18_06-14-37"></p><p>然后重启主机就可以看到 VMware 会开机自启，并且其中的虚拟 devos 也会自动启动。</p><h2 id="_5-主机关机关闭" tabindex="-1"><a class="header-anchor" href="#_5-主机关机关闭"><span>5. 主机关机关闭</span></a></h2><p>让虚拟系统 devos 跟随主机关机，前提需要安装的是 VMware Workstation 且安装了 VMware Tools(一般默认会安装)。</p><p>我这里安装的 VMware Workstation 17 pro，在<strong>虚拟系统关机</strong>的情况下操作：</p><p><img src="https://cdn.jsdelivr.net/gh/Ma-yeah/picx-images-hosting@master/2022-08-28/PixPin_2025-06-18_07-38-16.9dd809qfyr.webp" alt="PixPin_2025-06-18_07-38-16"></p><hr><div class="hint-container note"><p class="hint-container-title">本文参考</p><ul><li><a href="https://www.cnblogs.com/funlyp/p/18801160" target="_blank" rel="noopener noreferrer">VMware workstation 17 pro 设置开机自启虚拟机（Windows 11）</a></li><li><a href="https://cloud.tencent.com/developer/article/2298022" target="_blank" rel="noopener noreferrer">VMware pro 17设置虚拟机随宿主机开机自启动</a></li></ul></div>`,36)])])}const l=i(n,[["render",h]]),k=JSON.parse('{"path":"/article/hfgdbcz2/","title":"VM虚拟机安装ubuntu22.04.1","lang":"zh-CN","frontmatter":{"title":"VM虚拟机安装ubuntu22.04.1","tags":["Ubuntu","虚拟机"],"categories":["Linux"],"createTime":"2022/08/28 16:10:07","permalink":"/article/hfgdbcz2/"},"readingTime":{"minutes":2.9,"words":870},"git":{"createdTime":1769985102000,"updatedTime":1769985102000,"contributors":[{"name":"Mayee","username":"Mayee","email":"may675154357@gmail.com","commits":1,"avatar":"https://avatars.githubusercontent.com/Mayee?v=4","url":"https://github.com/Mayee"}]},"filePathRelative":"blog/5.运维/1.VM虚拟机安装ubuntu22.04.1.md","headers":[],"categoryList":[{"id":"190c84","sort":5,"name":"运维"}]}');export{l as comp,k as data};
