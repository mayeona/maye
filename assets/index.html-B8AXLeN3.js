import{_ as n,c as l,b as i,a,d as t,e as h,r as d,o as p}from"./app-B_sKV6fk.js";const k={},r={class:"code-block-title","data-title":"logind.conf"},o={class:"code-block-title-bar"},c={class:"title"};function g(u,s){const e=d("VPIcon");return p(),l("div",null,[s[2]||(s[2]=i('<h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言"><span>前言</span></a></h2><p>家里的旧笔记本性能过时，又弃之可惜，就算拿去卖二手也就能换个不锈钢脸盆。但是如果把它当做一个小型服务器或者 NAS，那就是让它重生。</p><h2 id="nas系统选型" tabindex="-1"><a class="header-anchor" href="#nas系统选型"><span>NAS系统选型</span></a></h2><p>对于商业闭源的 NAS 系统不在本文范围内。</p><h3 id="fnos" tabindex="-1"><a class="header-anchor" href="#fnos"><span>FnOS</span></a></h3><p>对于 amd64 平台来说，首当其冲就是飞牛了。对于不算太老的电脑，都能使用可视化安装，特别老的比如 10 年前的电脑，那需要用救援模式安装。</p><p><strong>安装要点</strong>：</p><ul><li>确保 BIOS 中是 UEFI 启动；</li><li>可以用 rufus 或 ventoy 做启动盘；</li><li>如果是救援模式安装，最好用 rufus，因为 ventoy 安装可能出现搜索不到本地镜像的情况；</li><li>对于特别老的电脑，使用旧版的 rufus，比如 rufus 3.15</li></ul><p><strong>使用要点</strong>：</p><ol><li>默认情况下笔记本合盖系统会休眠。解决方法：</li></ol>',10)),a("div",r,[a("div",o,[a("span",c,[t(e,{provider:"iconify",name:"vscode-icons:file-type-config"}),s[0]||(s[0]=h("logind.conf",-1))])]),s[1]||(s[1]=i(`<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nano</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/systemd/logind.conf</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 将 HandleLidSwitch、HandleLidSwitchExternalPower、HandleLidSwitchDocked 解除注释并修改值为 ignore，将 LidSwitchIgnoreInhibited 解除注释并修改值为 yes</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 使修改生效</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemd-logind</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1))]),s[3]||(s[3]=i(`<h3 id="openmediavault" tabindex="-1"><a class="header-anchor" href="#openmediavault"><span>OpenMediaVault</span></a></h3><p>飞牛虽然是好用，但占用资源比较高，对老配置电脑不太友好，那么就可以选择轻量级的 NAS 系统 OpenMediaVault，一样适合 amd64 平台。</p><p>系统安装非常简单，没有什么坑点。</p><p><strong>使用要点</strong>：</p><ol><li>系统启动时会出现 grub 菜单，但需要手动回车才能进入系统。解决方法：</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># GRUB_TIMEOUT=0 表示菜单超时时间为 0，GRUB_TIMEOUT_STYLE 表示不显示 rgub 菜单</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 此时启动就会直接进入系统</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> sed</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -i</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">s/^GRUB_TIMEOUT=.*/GRUB_TIMEOUT=0/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/default/grub</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> sed</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -i</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">s/^#GRUB_TIMEOUT_STYLE=.*/GRUB_TIMEOUT_STYLE=hidden/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/default/grub</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> update-grub</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 或者设置 菜单超时时间为 3s，这样可以留有时间手动选择</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> sed</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -i</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">s/^GRUB_TIMEOUT=.*/GRUB_TIMEOUT=3/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/default/grub</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> sed</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -i</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">s/^#GRUB_TIMEOUT_STYLE=.*/GRUB_TIMEOUT_STYLE=menu/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/default/grub</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> update-grub</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 修改菜单默认项，0 表示第一项，以此类推</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> grub-set-default</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 以上修改后，必须执行此命令生效，会自动生成文件 /boot/grub/grub.cfg</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> update-grub</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>笔记本合盖系统会休眠，解决方法同飞牛。</li><li>首次安装后可能会提示有很多依赖需要更新，建议使用官方命令更新：<code>sudo omv-upgrade</code></li><li>安装 OMV-Extras 插件仓库：</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">wget</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -O</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> https://github.com/OpenMediaVault-Plugin-Developers/packages/raw/master/install</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> bash</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="5"><li>安装 Docker。在安装完 OMV-Extras 仓库后，搜索插件<code>docker</code>，选择<code>openmediavault-compose</code>安装，确保网络通畅能够正确安装，然后在<code>系统</code>-&gt;<code>omv-extras</code>先不要勾选<code>Docker repo</code>保存。<br> 接着在<code>服务</code>-&gt;<code>Compose</code>-&gt;<code>设置</code>中查看有三处需要设置目录的地方，需要先在<code>存储器</code>-&gt;<code>共享文件夹</code>设置三个目录待用。再回到刚刚 Compose 的设置页面，依次执行最下面的<code>启动Docker源</code>、<code>重新安装Docker</code>、<code>重启Docker</code>，完成后再设置好 Compose 的目录然后保存。</li></ol><p>之后就可以在 SSH 中验证<code>docker version</code>、<code>docker compose version</code>。</p><h3 id="zimaos" tabindex="-1"><a class="header-anchor" href="#zimaos"><span>ZimaOS</span></a></h3><p>同样基于 amd64 平台，是 CasaOS 同一团队开发，所以整体 UI 和 CasaOS 如出一辙(比 OpenMediaVault 是要美观一些)，不同的是 ZimaOS 是完整的 NAS 系统。<br> ZimaOS 还支持 APP 访问。</p><p><strong>安装要点</strong>：</p><ul><li>官方推荐使用 balenaEtcher 烧录，不支持 Ventoy，且 BIOS 中使用 UEFI 启动，关闭 SecureBoot。</li></ul><p><strong>使用要点</strong>：</p><ul><li>笔记本合盖系统会休眠，解决方法同飞牛。</li><li>由于 ZimaOS 设计了<a href="https://www.zimaspace.com/docs/zh/zimaos/System-Quick-Recovery-Guide" target="_blank" rel="noopener noreferrer">双启动分区</a>，导致必须手动选择启动项。解决方法：</li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 先执行如下命令</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">grub-editenv</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /mnt/boot/EFI/BOOT/grubenv</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> set</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> A_OK=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">grub-editenv</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /mnt/boot/EFI/BOOT/grubenv</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> set</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> B_OK=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">grub-editenv</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /mnt/boot/EFI/BOOT/grubenv</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> set</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> A_TRY=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">grub-editenv</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /mnt/boot/EFI/BOOT/grubenv</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> set</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> B_TRY=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 再设置 /mnt/boot/EFI/BOOT/grub.cfg 文件中 set timeout=0</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 重启</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> reboot</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="hinas" tabindex="-1"><a class="header-anchor" href="#hinas"><span>HiNas</span></a></h3><p>适合 arm64 平台。</p>`,19))])}const v=n(k,[["render",g]]),b=JSON.parse('{"path":"/article/kliotj5l/","title":"NAS使用相关","lang":"zh-CN","frontmatter":{"title":"NAS使用相关","tags":["nas"],"categories":["其他"],"createTime":"2025/10/10 23:40:02","permalink":"/article/kliotj5l/"},"readingTime":{"minutes":3.16,"words":949},"git":{"createdTime":1769985102000,"updatedTime":1769985102000,"contributors":[{"name":"Mayee","username":"Mayee","email":"may675154357@gmail.com","commits":1,"avatar":"https://avatars.githubusercontent.com/Mayee?v=4","url":"https://github.com/Mayee"}]},"filePathRelative":"blog/11.其他/5.NAS使用相关.md","headers":[],"categoryList":[{"id":"867696","sort":11,"name":"其他"}]}');export{v as comp,b as data};
