import{_ as l,c as h,b as a,a as s,d as t,e,r as k,o as p}from"./app-B_sKV6fk.js";const r={},g={class:"code-block-title","data-title":"nginx-service.exe.config"},d={class:"code-block-title-bar"},o={class:"title"},c={class:"code-block-title","data-title":"nginx-service.xml"},y={class:"code-block-title-bar"},x={class:"title"};function D(E,i){const n=k("VPIcon");return p(),h("div",null,[i[4]||(i[4]=a('<h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言"><span>前言</span></a></h2><p>由于开发需要，我这台小米笔记本的性能和配置已经不够用了，索性上了台式主机。笔记本用来打开 IDEA 用够了，开发会用到的服务都在台式机上跑。</p><p>但年关将近，笔记本是可以轻松带回去，台式主机却不好拿，虽然我的主机体积不大，但重量还是不轻，非必要我是不会拎着到处跑。</p><p>所以就需要能够远程访问到我这台主机，这样一来主机自动开机、内网穿透就是必须的了。好在内网穿透服务很早就购买了，只是用的比较少，向日葵开机插座也已经下单，万事具备。不过内网穿透的允许映射的端口数量有限，那就只能通过 Nginx 来转发端口了，因此想到了在 Windows 上将 Nginx 注册为服务，并设置开机自启。</p><h2 id="_1-下载并安装-nginx" tabindex="-1"><a class="header-anchor" href="#_1-下载并安装-nginx"><span>1. 下载并安装 Nginx</span></a></h2><p>访问 Nginx <a href="http://nginx.org/en/download.html" target="_blank" rel="noopener noreferrer">下载</a> 页面，选择 <strong>Stable version</strong> 标签下的 <code>nginx/Windows-1.20.2</code> 下载完成后得到一个 <code>nginx-1.20.1.zip</code> 的压缩包，解压至合适的目录，这里我解压在了 <code>C:\\Config\\nginx-1.20.1</code> 目录下，此目录即为 Nginx 的安装目录，此时 Nginx 就已经安装好了。</p><p>Nginx 常用命令(cmd/powershell)：</p><ul><li>启动：start nginx.exe</li><li>快速停止：nginx.exe -s stop</li><li>正常停止：nginx.exe -s quit</li><li>重载配置：nginx.exe -s reload</li><li>检查配置文件：nginx.exe -t -c conf/nginx.conf</li></ul><p>因为 Nginx 可以被启动多次，因此可能存在多个 Nginx 进程，而 <code>nginx.exe -s stop</code> 只能停止一个 Nginx 进程，因此：</p><ul><li>查看有多少 Nginx 在运行：tasklist /fi &quot;imagename eq nginx.exe&quot;</li><li>停止多个 Nginx 进程：taskkill /fi &quot;imagename eq nginx.exe&quot; /f 或 taskkill /f /t /im nginx.exe</li></ul><h2 id="_2-下载并安装-windows-service-wrapper" tabindex="-1"><a class="header-anchor" href="#_2-下载并安装-windows-service-wrapper"><span>2. 下载并安装 Windows Service Wrapper</span></a></h2><p>Windows Service Wrapper 是 Github 上一个开源软件，可以将任意<strong>可执行文件</strong>注册为 Windows 服务，例如：*.bat, *.jar, *.py 等。</p><p>在 <a href="https://github.com/winsw/winsw/releases" target="_blank" rel="noopener noreferrer">下载</a> 页面找到最新版本，根据自己系统是 32 位还是 64 位选择 <code>WinSW-x64.exe</code> 或 <code>WinSW-x86.exe</code>，此程序即为 Windows Service Wrapper。</p><p>例如我的 Windows 系统是 64 位，下载 <code>WinSW-x64.exe</code>，下载完成后放入 Nginx 安装目录 <code>C:\\Config\\nginx-1.20.1</code> 下，重命名为 <code>nginx-service.exe</code>，再创建两个文件：<code>nginx-service.exe.config</code>、<code>nginx-service.xml</code>。</p>',14)),s("div",g,[s("div",d,[s("span",o,[t(n,{provider:"iconify",name:"vscode-icons:file-type-config"}),i[0]||(i[0]=e("nginx-service.exe.config",-1))])]),i[1]||(i[1]=a(`<div class="language-xml" data-highlighter="shiki" data-ext="xml" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-xml"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">configuration</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">startup</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">supportedRuntime</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> version</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">v2.0.50727</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">supportedRuntime</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> version</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">v4.0</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">startup</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">runtime</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">generatePublisherEvidence</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> enabled</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">false</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">runtime</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">configuration</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span></code></pre></div>`,1))]),s("div",c,[s("div",y,[s("span",x,[t(n,{provider:"iconify",name:"vscode-icons:file-type-xml"}),i[2]||(i[2]=e("nginx-service.xml",-1))])]),i[3]||(i[3]=a(`<div class="language-xml" data-highlighter="shiki" data-ext="xml" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-xml"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">service</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">id</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">nginx</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">id</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Nginx Service</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">description</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">High Performance Nginx Service</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">description</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">logpath</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">C:\\Config\\nginx-1.20.1\\logs</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">logpath</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">log</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> mode</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">roll-by-size</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">sizeThreshold</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">10240</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">sizeThreshold</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">keepFiles</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">8</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">keepFiles</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">log</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">executable</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">C:\\Config\\nginx-1.20.1\\nginx.exe</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">executable</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">startarguments</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">-p C:\\Config\\nginx-1.20.1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">startarguments</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">stopexecutable</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">C:\\Config\\nginx-1.20.1\\nginx.exe</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">stopexecutable</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">stoparguments</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">-p C:\\Config\\nginx-1.20.1 -s stop</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">stoparguments</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">service</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&gt;</span></span></code></pre></div>`,1))]),i[5]||(i[5]=a('<p>注意，文件内容中的 Nginx 目录需要替换为自己的实际目录。</p><h2 id="_3-将-nginx-注册为服务" tabindex="-1"><a class="header-anchor" href="#_3-将-nginx-注册为服务"><span>3. 将 Nginx 注册为服务</span></a></h2><p>以管理员权限打开命令行工具，并进入到 Nginx 的安装目录。</p><ol><li>按下键盘上的 windows 键，接着输入 <code>cmd</code>，找到 <strong>命令提示符</strong>，然后右键单击 <strong>以管理员身份运行</strong>；</li><li>输入 <code>nginx-service.exe install</code> 安装服务；</li></ol><p>正常执行完上面两步操作即可注册成功，然后返回桌面右键单击 <strong>此电脑</strong>，选择 <strong>管理</strong>。接着在左侧的菜单树选择 <strong>服务和应用程序 -&gt; 服务</strong>，在右侧的服务列表中找到 <strong>Nginx Service</strong>，此时可以通过点击服务来启动、停止、重启 Nginx。</p><hr><p>补充 Windows Servcie Wrapper的命令格式如下：</p><ul><li>安装服务：winsw-wrapper.exe install</li><li>卸载服务：winsw-wrapper.exe uninstall</li><li>启动服务：winsw-wrapper.exe start</li><li>停止服务：winsw-wrapper.exe stop</li></ul>',8))])}const u=l(r,[["render",D]]),f=JSON.parse('{"path":"/article/l4ovczl4/","title":"Windows10下将Nginx注册为服务","lang":"zh-CN","frontmatter":{"title":"Windows10下将Nginx注册为服务","tags":["Nginx","Windows"],"categories":["技巧"],"createTime":"2022/01/22 15:17:56","permalink":"/article/l4ovczl4/"},"readingTime":{"minutes":3.04,"words":911},"git":{"createdTime":1699004244000,"updatedTime":1769985102000,"contributors":[{"name":"Mayee","username":"Mayee","email":"maye_e@qq.com","commits":2,"avatar":"https://avatars.githubusercontent.com/Mayee?v=4","url":"https://github.com/Mayee"}]},"filePathRelative":"blog/6.技巧/2.Windows10下将Nginx注册为服务.md","headers":[],"categoryList":[{"id":"f5b792","sort":6,"name":"技巧"}]}');export{u as comp,f as data};
