import{_ as d,c as r,a as s,d as l,b as g,e as a,w as n,r as k,o as c}from"./app-B_sKV6fk.js";const o={};function A(y,i){const e=k("VPLink"),p=k("Tabs");return c(),r("div",null,[i[9]||(i[9]=s("h2",{id:"前言",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#前言"},[s("span",null,"前言")])],-1)),s("p",null,[i[2]||(i[2]=a("之前在开发机(Ubuntu)上安装了",-1)),l(e,{href:"/article/7uov7swb/#_3-4-3-caddy-%E6%8E%A8%E8%8D%90"},{default:n(()=>[...i[0]||(i[0]=[a("Caddy",-1)])]),_:1}),i[3]||(i[3]=a("、在 R2S(OpenWrt)上安装了",-1)),l(e,{href:"/article/7dobd88o/#_3-%E5%AE%89%E8%A3%85-caddy"},{default:n(()=>[...i[1]||(i[1]=[a("Caddy",-1)])]),_:1}),i[4]||(i[4]=a("，每安装一次 Caddy 都会自动生成根证书，客户端设备想访问站点就得导入两个根证书，不如这些 Caddy 都使用相同的根证书，那客户端设备也就只需要导入一个根证书即可。",-1))]),i[10]||(i[10]=s("h2",{id:"_1-统一服务器根证书",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_1-统一服务器根证书"},[s("span",null,"1. 统一服务器根证书")])],-1)),i[11]||(i[11]=s("p",null,"证书所在目录如下：",-1)),l(p,{id:"12",data:[{id:"Ubuntu"},{id:"OpenWrt"}]},{title0:n(({value:t,isActive:h})=>[...i[5]||(i[5]=[a("Ubuntu",-1)])]),title1:n(({value:t,isActive:h})=>[...i[6]||(i[6]=[a("OpenWrt",-1)])]),tab0:n(({value:t,isActive:h})=>[...i[7]||(i[7]=[s("div",{class:"language-bash","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-bash"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 使用 apt 安装时目录属于 caddy 用户的，需要切换到 root 才能查看")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"sudo"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -i")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 根证书路径")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"cd"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /var/lib/caddy/.local/share/caddy/pki/authorities/local/")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 站点证书路径")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"cd"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /var/lib/caddy/.local/share/caddy/certificates/local/")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 退出 root")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"exit")])])])],-1)])]),tab1:n(({value:t,isActive:h})=>[...i[8]||(i[8]=[s("div",{class:"language-bash","data-highlighter":"shiki","data-ext":"bash",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-bash"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 根证书路径")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"cd"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /.local/share/caddy/pki/authorities/local/")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 站点证书路径")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"cd"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," /.local/share/caddy/certificates/local/")])])])],-1)])]),_:1}),i[12]||(i[12]=g(`<p>我打算统一为 OpenWrt 上 Caddy 生成的根证书，那么在 Ubuntu 系统的操作如下：</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 停止 Caddy</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> stop</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> caddy</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Caddy 根证书</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -i</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 删除根证书</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -rf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/lib/caddy/.local/share/caddy/pki/authorities/local/</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 删除站点证书</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -rf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/lib/caddy/.local/share/caddy/certificates/local/</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 复制证书(假设已经把 OpenWrt 上 /.local/share/caddy/pki/authorities/local/* 放在了 Ubuntu 的 ~/crt)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cp</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -r</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/crt/</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/lib/caddy/.local/share/caddy/pki/authorities/local/</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 设置权限</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> chown</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -R</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> caddy:caddy</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/lib/caddy/.local/share/caddy/pki/authorities/local</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 启动 Caddy</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> start</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> caddy</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 退出</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">exit</span></span></code></pre></div><p><mark>注意</mark>：当 Caddy 启动时会自动将根证书安装到服务器中，由于 Caddy 用户不是 root 用户，这个操作会失败，使用<code>sudo systemctl status caddy</code>查看时会看到提示<code>failed to install root certificate</code>。我们就需要手动安装根证书到系统：</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 手动复制证书</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/lib/caddy/.local/share/caddy/pki/authorities/local/root.crt</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/share/ca-certificates/Caddy_Local_CA.crt</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 更新系统 CA 信任库</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> update-ca-certificates</span></span></code></pre></div><h2 id="_2-统一-windows-根证书" tabindex="-1"><a class="header-anchor" href="#_2-统一-windows-根证书"><span>2. 统一 Windows 根证书</span></a></h2><p>先把之前导入的证书都删掉，按<code>Win+R</code>然后输入<code>certmgr.msc</code>打开证书管理器，找到之前导入的证书，右键删除即可。接着再重新导入根证书。</p><p>以前导入到浏览器中的证书，也可以再在浏览器中找到并删除。浏览器不会将系统中的证书导入到浏览器中，它会直接信任系统中的证书。</p><h2 id="_3-统一代理软件证书" tabindex="-1"><a class="header-anchor" href="#_3-统一代理软件证书"><span>3. 统一代理软件证书</span></a></h2><p>由于 ios 系统是信任用户导入的证书，因此 ios 上的代理软件通常都会有 MitM(Man-in-the-Middle Attack，中间人攻击) 功能，这就需要导入一个根证书并信任，代理软件就会使用这个根证书签发站点证书，从而实现 MitM。这个根证书一般是由代理软件自动生成，有效期为一年，当然可以手动导入已有的证书，所以我们也可以将前面的根证书导入进来。</p><p>支持手动导入证书的代理软件有：Surge、Loon、Shadowrocket、QuantumultX，这里我们以 Surge 为例，其他软件类似。</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 要安装 openssl 命令。 pass:123 表示安装证书时的密码，若不想要密码则留空 pass:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pkcs12</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -export</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -inkey</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.p12</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -name</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">dev</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -passout</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pass:123</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 需要安装 base64 命令。 将 p12 证书转为 base64 字符串。</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">base64</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -w</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.p12</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.p12.b64</span></span></code></pre></div><p>然后将<code>root.p12.b64</code>中的内容复制到 Surge 配置文件的中的<code>ca-p12</code>字段值，<code>ca-passphrase</code>字段值为 123。之后安装证书到系统并信任即可。</p><p>虽然我们在上面导出导出 p12 证书时指定了 name 为 <code>dev</code>，但是安装到手机时会发现证书名并不是 dev，而是<code>Caddy Local Authority - 2025 ECC Root</code>，这显示的其实时根证书的 Subject，可以通过命令查看<code>openssl x509 -in root.crt -noout -subject</code>。</p><p>如果一定强迫症想要显示指定的名字，只能重新生成根证书：</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> req</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -new</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -x509</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -days</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3650</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -subj</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/CN=dev</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre></div><p>这里<code>-subj</code>的值是有格式要求的，<code>/C=国家代码/ST=省份/L=城市/O=组织/OU=部门/CN=主机名或用户名/emailAddress=邮箱</code>，但不是所有值都必须。</p><h2 id="_4-同一代理软件使用自定义证书" tabindex="-1"><a class="header-anchor" href="#_4-同一代理软件使用自定义证书"><span>4. 同一代理软件使用自定义证书</span></a></h2><p>生成一个具有自定义标识的证书，然后导入代理软件中使用。<br> 首先在 Surge、Loon、QuantumultX 中自动生成证书并安装，然后对比差异，发现在证书的约束方面各有不同，其中 Surge 的最为宽松，故按照 Surge 的标准来生成一个证书。</p><p>首先创建一个证书配置文件<code>rootca.cnf</code>:</p><div class="code-block-title" data-title="rootca.cnf"><div class="code-block-title-bar"><span class="title">rootca.cnf</span></div><div class="language-cnf" data-highlighter="shiki" data-ext="cnf" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-cnf"><span class="line"><span>[ req ]</span></span>
<span class="line"><span>distinguished_name = req_distinguished_name</span></span>
<span class="line"><span>prompt = no</span></span>
<span class="line"><span>x509_extensions = v3_ca</span></span>
<span class="line"><span>default_bits = 2048</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[ req_distinguished_name ]</span></span>
<span class="line"><span>O  = Mayee</span></span>
<span class="line"><span>CN = Mayee Long-term support</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[ v3_ca ]</span></span>
<span class="line"><span>basicConstraints = CA:TRUE</span></span>
<span class="line"><span>keyUsage = keyCertSign</span></span>
<span class="line"><span>subjectKeyIdentifier = hash</span></span></code></pre></div></div><p>接着执行如下命令:</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 创建一个私钥(无密)。如果想要私钥加密则: openssl genpkey -algorithm RSA -aes256 -out RootCA.key -pkeyopt rsa_keygen_bits:2048</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> genpkey</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -algorithm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> RSA</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> RootCA.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -pkeyopt</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rsa_keygen_bits:2048</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">chmod</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 600</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> RootCA.key</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 使用私钥签发证书。-days 设置证书有效期(单位:天)。如果使用的加密私钥需输入私钥密码</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> req</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -x509</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -new</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -key</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> RootCA.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -sha256</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -days</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3650</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> RootCA.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -config</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rootca.cnf</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -extensions</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> v3_ca</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 生成 p12 证书，需要设置一个导入密码</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pkcs12</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -export</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> RootCA.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -inkey</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> RootCA.key</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> RootCA.p12</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -name</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Mayee Long-term support</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -passout</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pass:123</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 将 p12 证书用 base64 编码，方便复制到代理软件中</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">base64</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -w</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> RootCA.p12</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> RootCA.p12.txt</span></span></code></pre></div><p>在<code>rootca.cnf</code>中也就<code>[req_distinguished_name]</code>节下的内容自定义，其他不用动。</p><p>将 base64 后的证书及导入密码复制到代理软件中，然后在软件内安装证书会下载描述文件安装。注意，当前只有 Surge 支持自定义的证书安装描述文件，Loon 和 QuantumultX 安装描述文件时会提示错误，这并不是证书有问题，是因为它们只认自己生成的证书来作为描述文件安装。解决方法：证书只需要安装一次即可，如果有 Surge 就用它安装，安装好后其他软件只需要配置好就能用了；如果没有 Surge 就把 p12 文件传到手机中，然后点击文件安装，输入安装密码即可。</p>`,24))])}const D=d(o,[["render",A]]),u=JSON.parse('{"path":"/article/bvixslcm/","title":"统一根证书","lang":"zh-CN","frontmatter":{"title":"统一根证书","tags":["caddy"],"createTime":"2025/06/25 14:00:14","permalink":"/article/bvixslcm/"},"readingTime":{"minutes":4.91,"words":1474},"git":{"createdTime":1769985102000,"updatedTime":1769985102000,"contributors":[{"name":"Mayee","username":"Mayee","email":"may675154357@gmail.com","commits":1,"avatar":"https://avatars.githubusercontent.com/Mayee?v=4","url":"https://github.com/Mayee"}]},"filePathRelative":"blog/6.技巧/6.统一根证书.md","headers":[],"categoryList":[{"id":"f5b792","sort":6,"name":"技巧"}]}');export{D as comp,u as data};
