---
title: NAS使用相关
tags:
  - nas
categories:
  - 其他
createTime: 2025/10/10 23:40:02
permalink: /article/kliotj5l/
---

## 前言

家里的旧笔记本性能过时，又弃之可惜，就算拿去卖二手也就能换个不锈钢脸盆。但是如果把它当做一个小型服务器或者 NAS，那就是让它重生。

## NAS系统选型

对于商业闭源的 NAS 系统不在本文范围内。

### FnOS

对于 amd64 平台来说，首当其冲就是飞牛了。对于不算太老的电脑，都能使用可视化安装，特别老的比如 10 年前的电脑，那需要用救援模式安装。

**安装要点**：
- 确保 BIOS 中是 UEFI 启动；
- 可以用 rufus 或 ventoy 做启动盘；
- 如果是救援模式安装，最好用 rufus，因为 ventoy 安装可能出现搜索不到本地镜像的情况；
- 对于特别老的电脑，使用旧版的 rufus，比如 rufus 3.15

**使用要点**：
1. 默认情况下笔记本合盖系统会休眠。解决方法：
```bash title="logind.conf"
sudo nano /etc/systemd/logind.conf
# 将 HandleLidSwitch、HandleLidSwitchExternalPower、HandleLidSwitchDocked 解除注释并修改值为 ignore，将 LidSwitchIgnoreInhibited 解除注释并修改值为 yes
# 使修改生效
sudo systemctl restart systemd-logind
```

### OpenMediaVault

飞牛虽然是好用，但占用资源比较高，对老配置电脑不太友好，那么就可以选择轻量级的 NAS 系统 OpenMediaVault，一样适合 amd64 平台。

系统安装非常简单，没有什么坑点。

**使用要点**：
1. 系统启动时会出现 grub 菜单，但需要手动回车才能进入系统。解决方法：
```bash
# GRUB_TIMEOUT=0 表示菜单超时时间为 0，GRUB_TIMEOUT_STYLE 表示不显示 rgub 菜单
# 此时启动就会直接进入系统
sudo sed -i 's/^GRUB_TIMEOUT=.*/GRUB_TIMEOUT=0/' /etc/default/grub
sudo sed -i 's/^#GRUB_TIMEOUT_STYLE=.*/GRUB_TIMEOUT_STYLE=hidden/' /etc/default/grub
sudo update-grub

# 或者设置 菜单超时时间为 3s，这样可以留有时间手动选择
sudo sed -i 's/^GRUB_TIMEOUT=.*/GRUB_TIMEOUT=3/' /etc/default/grub
sudo sed -i 's/^#GRUB_TIMEOUT_STYLE=.*/GRUB_TIMEOUT_STYLE=menu/' /etc/default/grub
sudo update-grub

# 修改菜单默认项，0 表示第一项，以此类推
sudo grub-set-default 0

# 以上修改后，必须执行此命令生效，会自动生成文件 /boot/grub/grub.cfg
sudo update-grub
```
2. 笔记本合盖系统会休眠，解决方法同飞牛。
3. 首次安装后可能会提示有很多依赖需要更新，建议使用官方命令更新：`sudo omv-upgrade`
4. 安装 OMV-Extras 插件仓库：
```bash
wget -O - https://github.com/OpenMediaVault-Plugin-Developers/packages/raw/master/install | sudo bash
```
5. 安装 Docker。在安装完 OMV-Extras 仓库后，搜索插件`docker`，选择`openmediavault-compose`安装，确保网络通畅能够正确安装，然后在`系统`->`omv-extras`先不要勾选`Docker repo`保存。  
接着在`服务`->`Compose`->`设置`中查看有三处需要设置目录的地方，需要先在`存储器`->`共享文件夹`设置三个目录待用。再回到刚刚 Compose 的设置页面，依次执行最下面的`启动Docker源`、`重新安装Docker`、`重启Docker`，完成后再设置好 Compose 的目录然后保存。

之后就可以在 SSH 中验证`docker version`、`docker compose version`。

### ZimaOS

同样基于 amd64 平台，是 CasaOS 同一团队开发，所以整体 UI 和 CasaOS 如出一辙(比 OpenMediaVault 是要美观一些)，不同的是 ZimaOS 是完整的 NAS 系统。  
ZimaOS 还支持 APP 访问。

**安装要点**：
- 官方推荐使用 balenaEtcher 烧录，不支持 Ventoy，且 BIOS 中使用 UEFI 启动，关闭 SecureBoot。

**使用要点**：
- 笔记本合盖系统会休眠，解决方法同飞牛。
- 由于 ZimaOS 设计了[双启动分区](https://www.zimaspace.com/docs/zh/zimaos/System-Quick-Recovery-Guide)，导致必须手动选择启动项。解决方法：
```bash
# 先执行如下命令
grub-editenv /mnt/boot/EFI/BOOT/grubenv set A_OK=1
grub-editenv /mnt/boot/EFI/BOOT/grubenv set B_OK=0
grub-editenv /mnt/boot/EFI/BOOT/grubenv set A_TRY=0
grub-editenv /mnt/boot/EFI/BOOT/grubenv set B_TRY=0

# 再设置 /mnt/boot/EFI/BOOT/grub.cfg 文件中 set timeout=0
# 重启
sudo reboot
```

### HiNas

适合 arm64 平台。
